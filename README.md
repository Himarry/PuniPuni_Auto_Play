# 妖怪ウォッチぷにぷに 自動プレイ

妖怪ウォッチぷにぷにのプレイボタンと閉じるボタンの自動タップソフトウェア

## 動作仕様

### 優先度とロジック
1. **タップしない画像の確認**: ごうかん、メニュー、ランキング、ゆうびんボタンが検出された場合、何もタップしません
2. **プレイボタン優先**: play_1またはplay_2が検出された場合、プレイボタンのみをタップし、他のボタンは無視します
3. **通常ボタン処理**: プレイボタンとタップしない画像が検出されない場合、next、close、close_mini、okボタンを処理します

### 検出・タップの流れ
```
スクリーンショット取得
↓
タップしない画像をチェック
↓
検出あり → 何もしない（ログ出力のみ）
↓
検出なし → プレイボタンをチェック
↓
プレイボタンあり → プレイボタンをタップ
↓
プレイボタンなし → 通常ボタン（next/close/ok）を処理
```

## 対応画像

### タップする画像
- `play_1.png` - プレイボタン1（最優先）
- `play_2.png` - プレイボタン2（最優先）  
- `next.png` - 次へボタン
- `close.png` - 閉じるボタン
- `close_mini.png` - 小さい閉じるボタン
- `ok.png` - OKボタン

### タップしない画像（検出のみ）
- `goukan.png` - ごうかんボタン
- `menu.png` - メニューボタン
- `ranking.png` - ランキングボタン
- `yuubin.png` - ゆうびんボタン

## 必要な環境

### ソフトウェア要件
- Python 3.7以上
- Android Debug Bridge (ADB)
- Androidデバイス（USB接続またはWiFi接続）

### Pythonパッケージ
- opencv-python
- numpy
- Pillow
- tkinter (通常Pythonに標準搭載)

## セットアップ

### 1. Pythonパッケージのインストール
```bash
pip install -r requirements.txt
```

### 2. ADBのセットアップ
1. Android SDK Platform Toolsをダウンロード
2. platform-toolsフォルダをPATHに追加
3. コマンドプロンプトで `adb version` が動作することを確認

### 3. Androidデバイスの設定
1. 設定 → 開発者向けオプション → USBデバッグを有効化
2. USBケーブルでPCに接続
3. デバッグ許可のダイアログで「許可」を選択

## 使用方法

### 1. アプリケーションの起動
```bash
python main.py
```

### 2. デバイスの選択
1. 「デバイス更新」ボタンをクリック
2. 接続されたデバイスを選択

### 3. 設定の調整
- **タップ間隔**: タップの間隔を秒単位で設定
- **検出精度**: 画像検出の精度を0.5〜1.0で設定

### 4. 自動化の実行
1. 「自動化開始」ボタンをクリック
2. 妖怪ウォッチぷにぷにを起動
3. 自動的に画像を検出してタップが実行されます
4. 停止する場合は「自動化停止」ボタンをクリック

### 5. 画像管理機能
GUI上で画像の追加・削除ができます：

#### 画像の追加
1. **タップする画像を追加**: 新しくタップしたいボタンの画像を追加
2. **タップしない画像を追加**: 検出はするがタップしない画像を追加
3. 対応形式：PNG、JPG、JPEG

#### 画像の削除
1. 画像一覧から削除したい画像を選択
2. 「選択した画像を削除」ボタンをクリック
3. 確認ダイアログで「はい」を選択

#### 画像の分類
- **[タップする]**: 検出時に自動的にタップされる画像
- **[タップしない]**: 検出時にログ出力のみで、タップしない画像

### 6. 誤タップ防止機能
特定のボタンに対する誤タップを防止できます：
- **ごうかんボタン**: チェックしていると、ごうかんボタンを検出してもタップしません
- **ゆうびんボタン**: ゆうびんボタンの誤タップを防止
- **ランキングボタン**: ランキングボタンの誤タップを防止  
- **メニューボタン**: メニューボタンの誤タップを防止

### 7. テスト機能
「画像検出テスト」ボタンで現在の画面で画像が検出できるかテスト可能

## ファイル構成

```
PuniPuni_Auto_Play/
├── main.py                 # メインGUIアプリケーション
├── automation_engine.py    # 自動化処理エンジン
├── image_detector.py       # 画像検出機能
├── device_controller.py    # ADBデバイス制御
├── config_manager.py       # 設定管理
├── requirements.txt        # 必要パッケージ一覧
├── README.md              # このファイル
├── image/                 # 検出対象画像フォルダ
│   ├── play_1.png        # タップする画像
│   ├── play_2.png
│   ├── next.png
│   ├── close.png
│   ├── close_mini.png
│   ├── ok.png
│   ├── goukan.png        # タップしない画像
│   ├── menu.png
│   ├── ranking.png
│   └── yuubin.png
└── config.json            # 設定ファイル（自動生成）
```

## トラブルシューティング

### デバイスが検出されない場合
1. USBデバッグが有効になっているか確認
2. `adb devices` コマンドでデバイスが表示されるか確認
3. ADBサーバーを再起動: `adb kill-server` → `adb start-server`

### 画像が検出されない場合
1. 検出精度を下げてみる（0.7程度）
2. 画像検出テストで現在の状況を確認
3. imageフォルダ内の画像ファイルが存在するか確認

### タップが効かない場合
1. デバイスの画面がロックされていないか確認
2. 妖怪ウォッチぷにぷにが前面に表示されているか確認
3. タップ間隔を長めに設定してみる

## 注意事項

- 本ソフトウェアは教育目的で作成されています
- ゲームの利用規約に従って使用してください
- 自動化による不利益について開発者は責任を負いません
- デバイスのバッテリー消費にご注意ください

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
